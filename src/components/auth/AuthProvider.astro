---
// This component wraps content that needs access to the AuthContext
---

<script>
  // Client-side script to set up the auth provider
  import { AuthProvider as ReactAuthProvider } from '../../context/AuthContext';
  import React from 'react';
  import { createRoot } from 'react-dom/client';

  console.log('AuthProvider.astro script executed');

  // Find all AuthProvider instances on the page
  document.addEventListener('DOMContentLoaded', () => {
    console.log('DOM loaded, initializing AuthProvider');
    const authProviders = document.querySelectorAll('.auth-provider-wrapper');
    console.log('Found AuthProvider instances:', authProviders.length);
    
    authProviders.forEach((container, index) => {
      console.log(`Initializing AuthProvider ${index+1}`);
      try {
        // Store the original HTML content
        const originalContent = container.innerHTML;
        console.log(`Provider ${index+1} has content:`, !!originalContent);
        
        // Create React root and render the AuthProvider
        const root = createRoot(container);
        root.render(
          React.createElement(
            ReactAuthProvider,
            null,
            React.createElement('div', { 
              className: 'auth-provider-content',
              dangerouslySetInnerHTML: { __html: originalContent }
            })
          )
        );
        console.log(`AuthProvider ${index+1} initialized successfully`);
      } catch (error) {
        console.error(`Error initializing AuthProvider ${index+1}:`, error);
      }
    });
  });
</script>

<div class="auth-provider-wrapper">
  <slot />
</div>